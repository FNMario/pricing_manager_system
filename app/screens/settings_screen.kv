#:kivy 2.2.1
#:import IconButton screens.widgets.iconbutton
#:import TextField screens.widgets.textfield
#:import DataTable screens.widgets.datatable

<AccordionItemTitle>:
    bold: True
    markup: True
    font_size: 20

<BigIconButton@IconButton>:
    size: dp(25), dp(25)

<Space@Label>:
    text: ""

<SettingsScreen>:
    Accordion:
        orientation: 'vertical'
        # Fractions
        AccordionItem:
            title: "[color=222431]Fractions[/color]"
            BoxLayout:
                orientation: 'vertical'
                pos_hint: {'top': 1}
                size_hint_y: None
                height: self.minimum_height
                padding: 0, dp(8)
                spacing: dp(5)
                DataTable:
                    id: tbl_fractions
                    size_hint_y: None
                    height: dp(450)
                    hint_sizes: [0.15, 0.3, 1, 0.5, 0.4, 0.4, 0.4]
                    header: ["id", "Name", "Description", "Unit", "Fraction 1", "Fraction 2", "Fraction 3"]
                    items: root.get_fractions_items()
                    on_selected_row: root.on_selected_row(lyt_form_fractions, self.items[self.selected_row])
                # Form
                BoxLayout:
                    id: lyt_form_fractions
                    orientation: 'horizontal'
                    size_hint_y: None
                    height: dp(50)
                    padding: dp(10), 0
                    spacing: dp(10)
                    TextField:
                        size_hint_x: None
                        width: dp(40)
                        TextInput:
                            id: txt_id
                            hint_text: "id"
                            disabled: True
                    TextField:
                        size_hint_x: 0.3
                        TextInput:
                            id: txt_alias
                            hint_text: "Name"
                            on_text: root.all_upper_case(self, 3)
                    TextField:
                        size_hint_x: 1
                        TextInput:
                            id: txt_description
                            hint_text: "Description"
                    TextField:
                        size_hint_x: 0.4
                        TextInput:
                            id: txt_unit
                            hint_text: "Unit"
                    TextField:
                        size_hint_x: 0.4
                        TextInput:
                            id: txt_fraction_1
                            hint_text: "Fraction 1"
                            input_filter: 'float'
                    TextField:
                        size_hint_x: 0.4
                        TextInput:
                            id: txt_fraction_2
                            hint_text: "Fraction 2"
                            input_filter: 'float'
                    TextField:
                        size_hint_x: 0.4
                        TextInput:
                            id: txt_fraction_3
                            hint_text: "Fraction 3"
                            input_filter: 'float'
                    BigIconButton:
                        source: './assets/icons/save-disk_c.png'
                        on_press: root.btn_save_fraction(lyt_form_fractions)
                    BigIconButton:
                        source: './assets/icons/big-plus_c.png'
                        on_press: root.btn_add_fraction(lyt_form_fractions)
                    BigIconButton:
                        source: './assets/icons/big-cross_c.png'
                        on_press: root.clear_form(lyt_form_fractions)
                Label:
                    text: "* Fraction = -1 represents a closed package"
                    pos_hint: {'center_x': 0.5}
                    size_hint_y: None
                    height: dp(30)
                    size_hint_x: 0.98
                    text_size: self.size
                    font_size: dp(13)
        # Supliers
        AccordionItem:
            title: "[color=222431]Supliers[/color]"
            BoxLayout:
                orientation: 'vertical'
                pos_hint: {'top': 1}
                size_hint_y: None
                height: self.minimum_height
                padding: 0, dp(8)
                spacing: dp(5)
                DataTable:
                    id: tbl_suppliers
                    size_hint_y: None
                    height: dp(450)
                    hint_sizes: [0.2, 1, 1, 0.8, 0.8]
                    header: ["id", "Name", "Phone", "Email", "Address"]
                    items: root.get_suppliers_items()
                    on_selected_row: root.on_selected_row(lyt_form_suppliers, self.items[self.selected_row])
                # Form
                BoxLayout:
                    id: lyt_form_suppliers
                    orientation: 'horizontal'
                    size_hint_y: None
                    height: dp(50)
                    padding: dp(10), 0
                    spacing: dp(10)
                    TextField:
                        size_hint_x: None
                        width: dp(40)
                        TextInput:
                            id: txt_id
                            hint_text: "id"
                            disabled: True
                    TextField:
                        size_hint_x: 1
                        TextInput:
                            id: txt_alias
                            hint_text: "Name"
                            on_text: root.all_upper_case(self)
                    TextField:
                        size_hint_x: 0.8
                        TextInput:
                            id: txt_phone
                            hint_text: "Phone"
                    TextField:
                        size_hint_x: 1
                        TextInput:
                            id: txt_description
                            hint_text: "Email"
                    TextField:
                        size_hint_x: 0.8
                        TextInput:
                            id: txt_address
                            hint_text: "Address"
                    BigIconButton:
                        source: './assets/icons/save-disk_c.png'
                        on_press: root.btn_save_supplier(lyt_form_suppliers)
                    BigIconButton:
                        source: './assets/icons/big-plus_c.png'
                        on_press: root.btn_add_supplier(lyt_form_suppliers)
                    BigIconButton:
                        source: './assets/icons/big-cross_c.png'
                        on_press: root.clear_form(lyt_form_suppliers)
        # Sections
        AccordionItem:
            title: "[color=222431]Sections[/color]"
            BoxLayout:
                orientation: 'vertical'
                pos_hint: {'top': 1}
                size_hint_y: None
                height: self.minimum_height
                padding: 0, dp(8)
                spacing: dp(5)
                DataTable:
                    id: tbl_sections
                    size_hint_y: None
                    height: dp(450)
                    hint_sizes: [0.1, 1]
                    header: ["id", "Name"]
                    items: root.get_sections_items()
                    on_selected_row: root.on_selected_row(lyt_form_sections, self.items[self.selected_row])
                # Form
                BoxLayout:
                    id: lyt_form_sections
                    orientation: 'horizontal'
                    size_hint_y: None
                    height: dp(50)
                    padding: dp(10), 0
                    spacing: dp(10)
                    TextField:
                        size_hint_x: None
                        width: dp(40)
                        TextInput:
                            id: txt_id
                            hint_text: "id"
                            disabled: True
                    TextField:
                        size_hint_x: 1
                        TextInput:
                            id: txt_alias
                            hint_text: "Name"
                            on_text: root.all_upper_case(self)
                    BigIconButton:
                        source: './assets/icons/save-disk_c.png'
                        on_press: root.btn_save_section(lyt_form_sections)
                    BigIconButton:
                        source: './assets/icons/big-plus_c.png'
                        on_press: root.btn_add_section(lyt_form_sections)
                    BigIconButton:
                        source: './assets/icons/big-cross_c.png'
                        on_press: root.clear_form(lyt_form_sections)
                    Space
        # dollar and iva
        AccordionItem:
            title: "[color=222431]IVA and Dollar[/color]"
            BoxLayout:
                pos_hint: {'top': 1}
                size_hint_y: None
                height: self.minimum_height
                padding: 0, dp(8)
                spacing: dp(10)
                # Iva
                BoxLayout:
                    orientation: 'vertical'
                    size_hint_y: None
                    height: self.minimum_height
                    spacing: dp(5)
                    DataTable:
                        id: tbl_iva
                        size_hint_y: None
                        height: dp(450)
                        header: ["IVA"]
                        items: root.get_iva_items()
                        on_selected_row: root.on_selected_row(lyt_form_iva, self.items[self.selected_row])
                    # Form
                    BoxLayout:
                        id: lyt_form_iva
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(50)
                        padding: dp(10), 0
                        spacing: dp(10)
                        TextField:
                            TextInput:
                                id: txt_iva
                                hint_text: "IVA"
                                input_filter: 'float'
                        BigIconButton:
                            source: './assets/icons/save-disk_c.png'
                            on_press: root.btn_save_iva(tbl_iva.selected_row, float(txt_iva.text))
                        BigIconButton:
                            source: './assets/icons/big-plus_c.png'
                            on_press: root.btn_add_iva(float(txt_iva.text))
                        BigIconButton:
                            source: './assets/icons/big-cross_c.png'
                            on_press: root.clear_form(lyt_form_iva)
                        Space:
                # Dollar
                BoxLayout:
                    orientation: 'vertical'
                    size_hint_y: None
                    height: self.minimum_height
                    spacing: dp(5)
                    DataTable:
                        id: tbl_dollar
                        size_hint_y: None
                        height: dp(450)
                        header: ["Dollar"]
                        items: root.get_dollar_items()
                        on_selected_row: root.on_selected_row(lyt_form_dollar, self.items[self.selected_row])
                    # Form
                    BoxLayout:
                        id: lyt_form_dollar
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(50)
                        padding: dp(10), 0
                        spacing: dp(10)
                        TextField:
                            TextInput:
                                id: txt_dollar
                                hint_text: "Dollar"
                                input_filter: 'float'
                        BigIconButton:
                            source: './assets/icons/save-disk_c.png'
                            on_press: root.btn_save_dollar(tbl_dollar.selected_row - 1, float(txt_dollar.text))
                        BigIconButton:
                            source: './assets/icons/big-plus_c.png'
                            on_press: root.btn_add_dollar(float(txt_dollar.text))
                        BigIconButton:
                            source: './assets/icons/big-cross_c.png'
                            on_press: root.clear_form(lyt_form_dollar)
                        Space
